<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
       <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="table.js"></script>
        <link rel="stylesheet" href="table.css">
    <title>TABLE Excel Sheet</title>
    <style>
    .table {
        width: 100%;
        border-collapse: collapse;
      } 
      .th, td {
        padding: 10px;
        border: 1px solid #dee2e6;
      }
      input[type="text"] {
        border: none;
        outline: none;
        width: 100%;
      }
      input[type="checkbox"] {
        margin: 0;
      }
     .visible {
      visibility: visible !important;
    }
    .invisible {
      visibility: hidden !important;
    }
</style>
</head>
<body>
    <table class="table" id="dataTable">
        <thead>
            <tr>
                <th>Sl no.</th>
                <th>Topics</th>
                <th>Sub Topics</th>
                <th>Learnt By</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="dataTableBody">
            <tr>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
                <td><input type="text" onkeypress="checkEnter(event, this)"></td>
            </tr>
        </tbody>
    </table>
<script>
    function checkEnter(event, input) {
    if (event.key === 'Enter') {
        event.preventDefault(); // Prevent default action
        
        const row = input.closest('tr');
        const inputs = row.querySelectorAll('input[type="text"]');

        // Check if this input is the last one in the row
        if (input === inputs[inputs.length - 1]) {
            addRow(); // If it's the last input, add a new row
        } else {
            saveEdit(input); // Otherwise, save the edit
        }
    }
}

function addRow() {
    const tableBody = document.getElementById('dataTableBody');
    const newRow = tableBody.insertRow();
    const slNoCell = newRow.insertCell(0);
    slNoCell.innerText = tableBody.rows.length;

    newRow.insertCell(1).innerHTML = `<input type="text" onkeypress="checkEnter(event, this)">`;
    newRow.insertCell(2).innerHTML = `<input type="text" onkeypress="checkEnter(event, this)">`;
    newRow.insertCell(3).innerHTML = `<input type="text" onkeypress="checkEnter(event, this)">`;
    newRow.insertCell(4).innerHTML = `<input type="text" onkeypress="checkEnter(event, this)">`;
    newRow.insertCell(5).innerHTML = `<input type="text" onkeypress="checkEnter(event, this)">`;
    newRow.insertCell(6).innerHTML = `<input type="text" onkeypress="checkEnter(event, this)">`;

    // Focus on the new row's first input
    newRow.cells[1].querySelector('input').focus();
}

function updateSlNo() {
    const rows = document.querySelectorAll('#dataTableBody tr');
    rows.forEach((row, index) => {
        row.cells[0].innerText = index + 1; // Update serial numbers
    });
}
</script>

</body>
</html>